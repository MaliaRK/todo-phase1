---
id: 1
title: "Phase III Todo AI Chatbot Spec"
stage: spec
date_iso: "2026-01-12"
surface: "agent"
model: "claude-sonnet-4-5-20250929"
feature: "ai-chatbot"
branch: "001-ai-chatbot"
user: "user"
command: "/sp.specify Phase III (Todo AI Chatbot)\n# sp.specify — Phase III: Todo AI Chatbot (MCP + Agents)\n\n## Context\nWe have a single Git repository containing multiple phases of the \"Evolution of Todo\" project, organized using branches:\n- Phase I: CLI Todo App\n- Phase II: Full-Stack Web App (Next.js + FastAPI + SQLModel + Neon + Better Auth)\n\nThis specification applies ONLY to the Phase III branch and must build on top of Phase II without breaking or rewriting it.\n\n## Objective\nDefine a complete, spec-driven architecture for **Phase III**, introducing an **AI-powered conversational chatbot** that manages todos through natural language using:\n- OpenAI Agents SDK\n- Official MCP (Model Context Protocol) SDK\n- OpenAI ChatKit frontend\n- Stateless FastAPI backend\n- Persistent conversation state stored in Neon PostgreSQL\n\nNo manual coding is allowed. All implementation must be generated via Claude Code using Spec-Kit Plus.\n\n---\n\n## Core Requirements\n\n### Conversational AI Interface\n- Users must manage todos using natural language\n- The chatbot must support all **Basic Level Todo features**:\n  - Add task\n  - List tasks\n  - Update task\n  - Complete task\n  - Delete task\n\n### Stateless Architecture\n- FastAPI server must remain stateless\n- Conversation state must be persisted in the database\n- Every request must fully reconstruct context from stored messages\n\n---\n\n## Technology Stack\n\n| Component | Technology |\n|---------|------------|\n| Frontend | OpenAI ChatKit |\n| Backend | Python FastAPI |\n| AI Framework | OpenAI Agents SDK |\n| MCP Server | Official MCP SDK |\n| ORM | SQLModel |\n| Database | Neon Serverless PostgreSQL |\n| Authentication | Better Auth (JWT-based, from Phase II) |\n| LLM Provider | Cohere API (via OpenAI-compatible interface) |\n\n---\n\n## High-Level Architecture\n\n- ChatKit UI sends user messages\n- FastAPI exposes a single stateless chat endpoint\n- OpenAI Agent processes user intent\n- MCP server exposes task operations as tools\n- Agent invokes MCP tools\n- MCP tools interact with database via SQLModel\n- All conversation messages are stored in the database\n- Server holds no in-memory state between requests\n\n---\n\n## Database Models\n\n### Task\n- user_id\n- id\n- title\n- description\n- completed\n- created_at\n- updated_at\n\n### Conversation\n- user_id\n- id\n- created_at\n- updated_at\n\n### Message\n- user_id\n- id\n- conversation_id\n- role (user / assistant)\n- content\n- created_at\n\n---\n\n## Chat API Specification\n\n### Endpoint\n\n\nPOST /api/{user_id}/chat\n\n\n### Request\n| Field | Type | Required | Description |\n|-----|-----|---------|-------------|\n| conversation_id | integer | No | Existing conversation ID (new if absent) |\n| message | string | Yes | User's natural language input |\n\n### Response\n| Field | Type | Description |\n|-----|-----|-------------|\n| conversation_id | integer | Active conversation ID |\n| response | string | AI assistant reply |\n| tool_calls | array | MCP tools invoked |\n\n---\n\n## MCP Tool Specifications\n\nThe MCP server must expose the following **stateless tools**:\n\n### add_task\n- Parameters: user_id (required), title (required), description (optional)\n- Creates a task in the database\n\n### list_tasks\n- Parameters: user_id (required), status (optional: all/pending/completed)\n- Returns filtered task list\n\n### complete_task\n- Parameters: user_id (required), task_id (required)\n- Marks task as completed\n\n### delete_task\n- Parameters: user_id (required), task_id (required)\n- Deletes a task\n\n### update_task\n- Parameters: user_id (required), task_id (required), title/description (optional)\n- Updates task fields\n\nAll MCP tools:\n- Must NOT store state in memory\n- Must persist all changes directly to the database\n- Must enforce user ownership\n\n---\n\n## Agent Behavior Specification\n\nThe AI agent must:\n- Interpret natural language intent\n- Select appropriate MCP tool(s)\n- Chain tools when required (e.g., list → delete)\n- Confirm actions with friendly responses\n- Handle errors gracefully (task not found, invalid input)\n\n---\n\n## Stateless Conversation Flow\n\n1. Receive user message\n2. Fetch conversation history from database\n3. Append new message\n4. Store user message\n5. Run agent with MCP tools\n6. Execute tool calls\n7. Store assistant response\n8. Return response\n9. Discard all in-memory state\n\n---\n\n## Authentication & Security\n- All requests require valid JWT (Better Auth)\n- User identity der"
labels: ["specification", "ai-chatbot", "todo-app", "mcp", "agents-sdk"]
links:
  spec: "specs/001-ai-chatbot/spec.md"
  ticket: null
  adr: null
  pr: null
files_yaml:
  - "specs/001-ai-chatbot/spec.md"
  - "specs/001-ai-chatbot/checklists/requirements.md"
tests_yaml:
  - "No tests created yet"
outcome: "Successfully created specification for Phase III AI Chatbot feature with comprehensive requirements, user scenarios, and success criteria."
evaluation: "Specification is complete and ready for the next phase of development."
prompt_text: "Phase III (Todo AI Chatbot)\n# sp.specify — Phase III: Todo AI Chatbot (MCP + Agents)\n\n## Context\nWe have a single Git repository containing multiple phases of the \"Evolution of Todo\" project, organized using branches:\n- Phase I: CLI Todo App\n- Phase II: Full-Stack Web App (Next.js + FastAPI + SQLModel + Neon + Better Auth)\n\nThis specification applies ONLY to the Phase III branch and must build on top of Phase II without breaking or rewriting it.\n\n## Objective\nDefine a complete, spec-driven architecture for **Phase III**, introducing an **AI-powered conversational chatbot** that manages todos through natural language using:\n- OpenAI Agents SDK\n- Official MCP (Model Context Protocol) SDK\n- OpenAI ChatKit frontend\n- Stateless FastAPI backend\n- Persistent conversation state stored in Neon PostgreSQL\n\nNo manual coding is allowed. All implementation must be generated via Claude Code using Spec-Kit Plus.\n\n---\n\n## Core Requirements\n\n### Conversational AI Interface\n- Users must manage todos using natural language\n- The chatbot must support all **Basic Level Todo features**:\n  - Add task\n  - List tasks\n  - Update task\n  - Complete task\n  - Delete task\n\n### Stateless Architecture\n- FastAPI server must remain stateless\n- Conversation state must be persisted in the database\n- Every request must fully reconstruct context from stored messages\n\n---\n\n## Technology Stack\n\n| Component | Technology |\n|---------|------------|\n| Frontend | OpenAI ChatKit |\n| Backend | Python FastAPI |\n| AI Framework | OpenAI Agents SDK |\n| MCP Server | Official MCP SDK |\n| ORM | SQLModel |\n| Database | Neon Serverless PostgreSQL |\n| Authentication | Better Auth (JWT-based, from Phase II) |\n| LLM Provider | Cohere API (via OpenAI-compatible interface) |\n\n---\n\n## High-Level Architecture\n\n- ChatKit UI sends user messages\n- FastAPI exposes a single stateless chat endpoint\n- OpenAI Agent processes user intent\n- MCP server exposes task operations as tools\n- Agent invokes MCP tools\n- MCP tools interact with database via SQLModel\n- All conversation messages are stored in the database\n- Server holds no in-memory state between requests\n\n---\n\n## Database Models\n\n### Task\n- user_id\n- id\n- title\n- description\n- completed\n- created_at\n- updated_at\n\n### Conversation\n- user_id\n- id\n- created_at\n- updated_at\n\n### Message\n- user_id\n- id\n- conversation_id\n- role (user / assistant)\n- content\n- created_at\n\n---\n\n## Chat API Specification\n\n### Endpoint\n\n\nPOST /api/{user_id}/chat\n\n\n### Request\n| Field | Type | Required | Description |\n|-----|-----|---------|-------------|\n| conversation_id | integer | No | Existing conversation ID (new if absent) |\n| message | string | Yes | User's natural language input |\n\n### Response\n| Field | Type | Description |\n|-----|-----|-------------|\n| conversation_id | integer | Active conversation ID |\n| response | string | AI assistant reply |\n| tool_calls | array | MCP tools invoked |\n\n---\n\n## MCP Tool Specifications\n\nThe MCP server must expose the following **stateless tools**:\n\n### add_task\n- Parameters: user_id (required), title (required), description (optional)\n- Creates a task in the database\n\n### list_tasks\n- Parameters: user_id (required), status (optional: all/pending/completed)\n- Returns filtered task list\n\n### complete_task\n- Parameters: user_id (required), task_id (required)\n- Marks task as completed\n\n### delete_task\n- Parameters: user_id (required), task_id (required)\n- Deletes a task\n\n### update_task\n- Parameters: user_id (required), task_id (required), title/description (optional)\n- Updates task fields\n\nAll MCP tools:\n- Must NOT store state in memory\n- Must persist all changes directly to the database\n- Must enforce user ownership\n\n---\n\n## Agent Behavior Specification\n\nThe AI agent must:\n- Interpret natural language intent\n- Select appropriate MCP tool(s)\n- Chain tools when required (e.g., list → delete)\n- Confirm actions with friendly responses\n- Handle errors gracefully (task not found, invalid input)\n\n---\n\n## Stateless Conversation Flow\n\n1. Receive user message\n2. Fetch conversation history from database\n3. Append new message\n4. Store user message\n5. Run agent with MCP tools\n6. Execute tool calls\n7. Store assistant response\n8. Return response\n9. Discard all in-memory state\n\n---\n\n## Authentication & Security\n- All requests require valid JWT (Better Auth)\n- User identity der"
response_text: "I have successfully created the specification for the Phase III Todo AI Chatbot feature. Here's what was accomplished:\n\n1. **Generated Short Name**: \"ai-chatbot\" based on the feature description\n2. **Created Branch**: `001-ai-chatbot` (number 1 since no existing branches with this pattern existed)\n3. **Created Specification**: Comprehensive spec file at `specs/001-ai-chatbot/spec.md` covering:\n   - User scenarios and testing with prioritized user stories\n   - Functional requirements (20 specific requirements)\n   - Key entities (Task, Conversation, Message)\n   - Success criteria with measurable outcomes\n4. **Created Quality Checklist**: At `specs/001-ai-chatbot/checklists/requirements.md` to validate the specification\n\nThe specification covers all the core requirements from your feature description:\n- Natural language todo management using AI\n- Stateless architecture with persistent conversation state\n- Integration with the existing Phase II infrastructure\n- Support for all basic todo operations (add, list, update, complete, delete)\n- Proper authentication and security measures\n\nThe specification is ready for the next phase (`/sp.clarify` or `/sp.plan`) as all requirements have been validated and no clarification markers remain."
---

# PHR: Phase III Todo AI Chatbot Spec

## Summary
Successfully created specification for Phase III AI Chatbot feature with comprehensive requirements, user scenarios, and success criteria.

## Details
- **Stage**: spec
- **Date**: 2026-01-12
- **Feature**: ai-chatbot
- **Branch**: 001-ai-chatbot
- **Command**: /sp.specify

## Files Created
- specs/001-ai-chatbot/spec.md
- specs/001-ai-chatbot/checklists/requirements.md

## Outcome
Specification is complete and ready for the next phase of development.